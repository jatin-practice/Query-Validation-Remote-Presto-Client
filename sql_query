select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
selectedCountries=, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and paymenttype in (0)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and paymenttype in (0)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1430438400 and eventtime <= 1433116799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1430438400 and eventtime <= 1433116799  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1430438400 and eventtime <= 1433116799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1430438400 and eventtime <= 1433116799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1430438400 and eventtime <= 1433116799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1433116799 and (trip.endTime=0 or trip.endtime >= 1430438400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
selectedCountries=, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and paymenttype in (0)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and paymenttype in (0)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)  and trip.domesticARPU in (11,12)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  and trip.domesticARPU in (11,12)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  and trip.domesticARPU in (11,12)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)  and trip.domesticARPU in (11,12)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0)  and trip.domesticARPU in (11,12)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and domesticARPU in (11,12)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and paymenttype in (0)  and domesticARPU in (11,12)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and paymenttype in (0)  and domesticARPU in (11,12)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and paymenttype in (0)  and domesticARPU in (11,12)  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (11,12)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11,12)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11,12)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (11,12)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,12)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,12)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,12)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,12)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,12)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (11)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (11)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (11,12)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (11)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and domesticARPU in (11)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and domesticARPU in (11)  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and domesticARPU in (11)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and domesticARPU in (11)  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and domesticARPU in (11)  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select country countryName,  countryid , isocode isocode from countryib
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select country countryName,  countryid , isocode isocode from countryib
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join null countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
selector-ClientSelectorManager@487a77e4/0] but has failed to stop it. This is very likely to create a memory leak.
selector-ClientSelectorManager@487a77e4/1] but has failed to stop it. This is very likely to create a memory leak.
selector-ClientSelectorManager@487a77e4/2] but has failed to stop it. This is very likely to create a memory leak.
selector-ClientSelectorManager@487a77e4/3] but has failed to stop it. This is very likely to create a memory leak.
selector-ClientSelectorManager@487a77e4/4] but has failed to stop it. This is very likely to create a memory leak.
selector-ClientSelectorManager@487a77e4/5] but has failed to stop it. This is very likely to create a memory leak.
select VALUE_STRING timeZone from config where KEY_STRING = 'timeZone'
select country countryName,  countryid , isocode isocode from countryib
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
SELECT id, track_name, filter_string, filterLabel, start_old_year, start_old_month, case when start_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+(start_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3+start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') when start_old_timeformat!='%Y-%m-01 00:00:00' then replace(start_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_old_year || 'year')::interval + (start_old_month || 'month')::interval + (start_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldstartdate,case when end_old_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_old_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') when end_old_timeformat!='%Y-%m-01 00:00:00' then replace(end_old_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_old_year || 'year')::interval + (end_old_month || 'month')::interval + (end_old_day || 'day')::interval, 'YYYY-MM-DD') end as oldenddate,case when start_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (start_new_year || 'year')::interval +(trunc(EXTRACT(QUARTER FROM now()))*3 + start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') when start_new_timeformat!='%Y-%m-01 00:00:00' then replace(start_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date+ (start_new_year || 'year')::interval + (start_new_month || 'month')::interval + (start_new_day || 'day')::interval, 'YYYY-MM-DD') end as newstartdate,case when end_new_timeformat='%Y-((%m/3)*3)-01 00:00:00' then to_char(date_trunc('year', now())::date+ (end_new_year || 'year')::interval + ( trunc(EXTRACT(QUARTER FROM now()))*3 + end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD')  when end_new_timeformat!='%Y-%m-01 00:00:00' then replace(end_new_timeformat,' 00:00:00','')else to_char(date_trunc('month', now())::date - 1 + (end_new_year || 'year')::interval + (end_new_month || 'month')::interval + (end_new_day || 'day')::interval, 'YYYY-MM-DD') end as newenddate,end_old_year,end_old_month,start_new_year,start_new_month,end_new_year,end_new_month FROM tracker_out order by id asc
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select usage_volume_id usageVolumeId, threshold_id_mo_duration thresholdIdMo, threshold_id_mt_duration thresholdIdMt, threshold_id_mosms thresholdIdSMS, threshold_id_tonnage thresholdIdData  from overall_category_threshold where threshold_id_mo_duration <= 4 and threshold_id_mt_duration <= 4 and threshold_id_mosms <= 4 and threshold_id_tonnage <= 4 and threshold_type = 2
select country_id ,threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage,timestamp from roaming_thresholds_out where timestamp=0 union all select distinct country_id , threshold_id, mo_call_duration ,  mt_call_duration , mo_sms_count , tonnage, timestamp from roaming_thresholds_out where timestamp=(select max(timestamp) from roaming_thresholds_out)  and country_id not in (select distinct country_id from roaming_thresholds_out where timestamp=0) order by timestamp,country_id,threshold_id
select country countryName,  countryid , isocode isocode from countryib
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join countryregionib countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0 or trip.endtime >= 1430438400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1433116799 and (trip.endtime= 0  or trip.endtime >= 1430438400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0  or trip.endtime >= 1430438400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1430438400 and trip.eventtime <= 1433116799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1433116799 and (trip.endTime= 0 or trip.endtime >= 1430438400)
select attr.id attrId, attr.name attrName, attr.applicablemodules moduleId,  attr.dbcolumn db_column,  attr.columntype column_type, attr.charttype chart_type,  stringIdMap.displaystring catName, stringIdMap.stringid catValue, stringIdMap.namespace namespace, attrValue.id catId, attr.measure measure,  attr.isoverlay isoverlay  from ATTRIBUTE attr left join AttributeValue attrValue on attr.id = attrValue.attributeid  left join StringIDMap stringIdMap  on stringIdMap.namespace = attrValue.namespace  and stringIdMap.stringid = attrValue.stringid  order by attr.displayorder, attrValue.displayorder
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join countryregionib countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (457)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (457)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (457)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (457)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (457)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (457)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (457)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (457)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (457)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (457)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (457)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (457)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (11,13)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11,13)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11,13)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (11,13)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (11,13)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11,13)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11,13)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (11)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (11)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and domesticARPU in (11)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and domesticARPU in (11)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (11)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and trip.overallcategory in (2,3)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.overallcategory in (2,3)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.overallcategory in (2,3)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.overallcategory in (2,3)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and trip.overallcategory in (2,3)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.overallcategory in (2,3)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.overallcategory in (2,3)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.overallcategory in (2,3)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2,3)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.overallcategory in (2,3)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.overallcategory in (2,3)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and trip.overallcategory in (2)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.overallcategory in (2)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.overallcategory in (2)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.overallcategory in (2)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.overallcategory in (2)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.overallcategory in (2)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,472,481,494,497,506)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)
selectedCountries=305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.paymenttype categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.paymenttype ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.paymenttype) voiceview  on  trip.paymenttype = voiceview.paymenttype left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.paymenttype is null then  -1  else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.paymenttype) dataview  on  trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) imsicount,  sum(ceil(voiceview.eventDuration/60.0)) voice,  voiceview.eventType eventtype,  count(smsview.eventtime) mosmscount,  sum(dataview.uplinkUsage + dataview.downlinkUsage) /1048576.0 datausage,  sum(countryrelationib.isbordering) bordering,  sum(countryib.isleisuredestination) leisure,  sum(countryib.ispremiumleisuredestination) leisurePremium,  sum(countryib.countrygdp) lowGDP  from out_roamer_country_trip_usage_view trip  left join ( select subscriberIMSI,eventDuration,eventType from out_roamer_voice_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) voiceview  on  trip.subscriberIMSI = voiceview.subscriberIMSI left join ( select subscriberIMSI,eventtime from out_roamer_message_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799 and eventType = 0   and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) smsview  on  trip.subscriberIMSI = smsview.subscriberIMSI left join ( select subscriberIMSI,uplinkUsage,downlinkUsage from out_roamer_data_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) dataview  on  trip.subscriberIMSI = dataview.subscriberIMSI inner join countryib countryib  on countryib.countryid = trip.visitedcountryid inner join countryrelationib countryrelationib  on countryib.countryid = countryrelationib.visitedcountryid inner join  (select countryid countryid from networkib networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC = networkib.mcc and subscribermodel.homeMNC = networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI ) country  on country.countryid =   countryrelationib.homecountryid where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and  trip.subscriberIMSI in (select distinct trip.subscriberIMSI from out_roamer_country_trip_usage_view trip  where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  )  group by trip.visitedcountryid, voiceview.eventType]; SQL state [null]; error code [0]; Error fetching results; nested exception is java.sql.SQLException: Error fetching results
select count(distinct trip.subscriberIMSI) imsicount,  sum(ceil(voiceview.eventDuration/60.0)) voice,  voiceview.eventType eventtype,  count(smsview.eventtime) mosmscount,  sum(dataview.uplinkUsage + dataview.downlinkUsage) /1048576.0 datausage,  sum(countryrelationib.isbordering) bordering,  sum(countryib.isleisuredestination) leisure,  sum(countryib.ispremiumleisuredestination) leisurePremium,  sum(countryib.countrygdp) lowGDP  from out_roamer_country_trip_usage_view trip  left join ( select subscriberIMSI,eventDuration,eventType from out_roamer_voice_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) voiceview  on  trip.subscriberIMSI = voiceview.subscriberIMSI left join ( select subscriberIMSI,eventtime from out_roamer_message_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799 and eventType = 0   and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) smsview  on  trip.subscriberIMSI = smsview.subscriberIMSI left join ( select subscriberIMSI,uplinkUsage,downlinkUsage from out_roamer_data_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) dataview  on  trip.subscriberIMSI = dataview.subscriberIMSI inner join countryib countryib  on countryib.countryid = trip.visitedcountryid inner join countryrelationib countryrelationib  on countryib.countryid = countryrelationib.visitedcountryid inner join  (select countryid countryid from networkib networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC = networkib.mcc and subscribermodel.homeMNC = networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI ) country  on country.countryid =   countryrelationib.homecountryid where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and  trip.subscriberIMSI in (select distinct trip.subscriberIMSI from out_roamer_country_trip_usage_view trip  where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  )  group by trip.visitedcountryid, voiceview.eventType]; SQL state [null]; error code [0]; Error fetching results; nested exception is java.sql.SQLException: Error fetching results
select count(distinct trip.subscriberIMSI) imsicount,  sum(ceil(voiceview.eventDuration/60.0)) voice,  voiceview.eventType eventtype,  count(smsview.eventtime) mosmscount,  sum(dataview.uplinkUsage + dataview.downlinkUsage) /1048576.0 datausage,  sum(countryrelationib.isbordering) bordering,  sum(countryib.isleisuredestination) leisure,  sum(countryib.ispremiumleisuredestination) leisurePremium,  sum(countryib.countrygdp) lowGDP  from out_roamer_country_trip_usage_view trip  left join ( select subscriberIMSI,eventDuration,eventType from out_roamer_voice_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) voiceview  on  trip.subscriberIMSI = voiceview.subscriberIMSI left join ( select subscriberIMSI,eventtime from out_roamer_message_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799 and eventType = 0   and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) smsview  on  trip.subscriberIMSI = smsview.subscriberIMSI left join ( select subscriberIMSI,uplinkUsage,downlinkUsage from out_roamer_data_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) dataview  on  trip.subscriberIMSI = dataview.subscriberIMSI inner join countryib countryib  on countryib.countryid = trip.visitedcountryid inner join countryrelationib countryrelationib  on countryib.countryid = countryrelationib.visitedcountryid inner join  (select countryid countryid from networkib networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC = networkib.mcc and subscribermodel.homeMNC = networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI ) country  on country.countryid =   countryrelationib.homecountryid where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and  trip.subscriberIMSI in (select distinct trip.subscriberIMSI from out_roamer_country_trip_usage_view trip  where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  )  group by trip.visitedcountryid, voiceview.eventType]; SQL state [null]; error code [0]; Error fetching results; nested exception is java.sql.SQLException: Error fetching results
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.tonnagecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.tonnagecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.tonnagecategory) voiceview  on  trip.tonnagecategory = voiceview.tonnagecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.tonnagecategory is null then  -1  else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.tonnagecategory) dataview  on  trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.domesticARPU categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.domesticARPU ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.domesticARPU) voiceview  on  trip.domesticARPU = voiceview.domesticARPU left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.domesticARPU is null then  -1  else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.domesticARPU) dataview  on  trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.overallcategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.overallcategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.overallcategory) voiceview  on  trip.overallcategory = voiceview.overallcategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.overallcategory is null then  -1  else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.overallcategory) dataview  on  trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.model categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.model ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, tdi.model) voiceview  on  trip.model = voiceview.model left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.model is null then  'Unknown'  else tdi.model end model from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.model) dataview  on  trip.model = dataview.model order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and paymenttype in (0)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and paymenttype in (0)  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and paymenttype in (0)  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  and paymenttype in (0)  and  visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)
select count(distinct trip.subscriberIMSI) imsicount,  sum(ceil(voiceview.eventDuration/60.0)) voice,  voiceview.eventType eventtype,  count(smsview.eventtime) mosmscount,  sum(dataview.uplinkUsage + dataview.downlinkUsage) /1048576.0 datausage,  sum(countryrelationib.isbordering) bordering,  sum(countryib.isleisuredestination) leisure,  sum(countryib.ispremiumleisuredestination) leisurePremium,  sum(countryib.countrygdp) lowGDP  from out_roamer_country_trip_usage_view trip  left join ( select subscriberIMSI,eventDuration,eventType from out_roamer_voice_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) voiceview  on  trip.subscriberIMSI = voiceview.subscriberIMSI left join ( select subscriberIMSI,eventtime from out_roamer_message_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799 and eventType = 0   and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) smsview  on  trip.subscriberIMSI = smsview.subscriberIMSI left join ( select subscriberIMSI,uplinkUsage,downlinkUsage from out_roamer_data_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) dataview  on  trip.subscriberIMSI = dataview.subscriberIMSI inner join countryib countryib  on countryib.countryid = trip.visitedcountryid inner join countryrelationib countryrelationib  on countryib.countryid = countryrelationib.visitedcountryid inner join  (select countryid countryid from networkib networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC = networkib.mcc and subscribermodel.homeMNC = networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI ) country  on country.countryid =   countryrelationib.homecountryid where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  and  trip.subscriberIMSI in (select distinct trip.subscriberIMSI from out_roamer_country_trip_usage_view trip  where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  )  group by trip.visitedcountryid, voiceview.eventType]; SQL state [null]; error code [0]; Error fetching results; nested exception is java.sql.SQLException: Error fetching results
select count(distinct trip.subscriberIMSI) imsicount,  sum(ceil(voiceview.eventDuration/60.0)) voice,  voiceview.eventType eventtype,  count(smsview.eventtime) mosmscount,  sum(dataview.uplinkUsage + dataview.downlinkUsage) /1048576.0 datausage,  sum(countryrelationib.isbordering) bordering,  sum(countryib.isleisuredestination) leisure,  sum(countryib.ispremiumleisuredestination) leisurePremium,  sum(countryib.countrygdp) lowGDP  from out_roamer_country_trip_usage_view trip  left join ( select subscriberIMSI,eventDuration,eventType from out_roamer_voice_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) voiceview  on  trip.subscriberIMSI = voiceview.subscriberIMSI left join ( select subscriberIMSI,eventtime from out_roamer_message_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799 and eventType = 0   and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) smsview  on  trip.subscriberIMSI = smsview.subscriberIMSI left join ( select subscriberIMSI,uplinkUsage,downlinkUsage from out_roamer_data_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) dataview  on  trip.subscriberIMSI = dataview.subscriberIMSI inner join countryib countryib  on countryib.countryid = trip.visitedcountryid inner join countryrelationib countryrelationib  on countryib.countryid = countryrelationib.visitedcountryid inner join  (select countryid countryid from networkib networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC = networkib.mcc and subscribermodel.homeMNC = networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI ) country  on country.countryid =   countryrelationib.homecountryid where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  and  trip.subscriberIMSI in (select distinct trip.subscriberIMSI from out_roamer_country_trip_usage_view trip  where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  )  group by trip.visitedcountryid, voiceview.eventType]; SQL state [null]; error code [0]; Error fetching results; nested exception is java.sql.SQLException: Error fetching results
select count(distinct trip.subscriberIMSI) imsicount,  sum(ceil(voiceview.eventDuration/60.0)) voice,  voiceview.eventType eventtype,  count(smsview.eventtime) mosmscount,  sum(dataview.uplinkUsage + dataview.downlinkUsage) /1048576.0 datausage,  sum(countryrelationib.isbordering) bordering,  sum(countryib.isleisuredestination) leisure,  sum(countryib.ispremiumleisuredestination) leisurePremium,  sum(countryib.countrygdp) lowGDP  from out_roamer_country_trip_usage_view trip  left join ( select subscriberIMSI,eventDuration,eventType from out_roamer_voice_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) voiceview  on  trip.subscriberIMSI = voiceview.subscriberIMSI left join ( select subscriberIMSI,eventtime from out_roamer_message_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799 and eventType = 0   and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) smsview  on  trip.subscriberIMSI = smsview.subscriberIMSI left join ( select subscriberIMSI,uplinkUsage,downlinkUsage from out_roamer_data_usage_trip_view where eventtime >= 1388534400 and eventtime <= 1391212799  and  visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  ) dataview  on  trip.subscriberIMSI = dataview.subscriberIMSI inner join countryib countryib  on countryib.countryid = trip.visitedcountryid inner join countryrelationib countryrelationib  on countryib.countryid = countryrelationib.visitedcountryid inner join  (select countryid countryid from networkib networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC = networkib.mcc and subscribermodel.homeMNC = networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI ) country  on country.countryid =   countryrelationib.homecountryid where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid not in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  and  trip.subscriberIMSI in (select distinct trip.subscriberIMSI from out_roamer_country_trip_usage_view trip  where (trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400) )  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  )  group by trip.visitedcountryid, voiceview.eventType]; SQL state [null]; error code [0]; Error fetching results; nested exception is java.sql.SQLException: Error fetching results
selectedCountries=305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510, selectedAttributes={paymenttype=java.lang.Integer:0}, dateFrom=1388534400, dateTo=1391212799]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime ]
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  and trip.paymenttype in (0)
selectedCountries=305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
selectedCountries=305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (334,523,510)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (334,523,510)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (334,523,510)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (334,523,510)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
selectedCountries=334,523,510, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (334,523,510)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (334,523,510)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (334,523,510)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and  trip.visitedcountryid in (334,523,510)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and  trip.visitedcountryid in (334,523,510)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
selectedCountries=, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,320,330,333,334,337,338,343,350,358,372,380,396,401,417,421,426,445,446,464,523,472,481,494,497,506,510)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (334,523,510)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,318,320,330,333,334,337,338,343,350,358,365,372,380,395,396,401,417,421,426,445,446,464,523,472,481,483,490,494,497,506,510)
selectedCountries=, selectedAttributes={}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
selectedCountries=, selectedAttributes={paymenttype=java.lang.Integer:0}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime ]
selectedCountries=, selectedAttributes={paymenttype=java.lang.Integer:0}, dateFrom=1388534400, dateTo=1391212799]
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime ]
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0)
