select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1422748799 and (trip.endtime= 0 or trip.endtime >= 1420070400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select distinct M.model model, M.manufacturer manufacturer, M.device_hierarchy_type devicecategory from tacdeviceib M where M.tac in ( select distinct tac from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1422748799 and (trip.endtime= 0 or trip.endtime >= 1420070400) )
select distinct countryib.country countryName,countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1422748799 and (trip.endtime= 0 or trip.endtime >= 1420070400) ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount mosmscount from (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1422748799 and (trip.endtime= 0 or trip.endtime >= 1420070400) group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1420070400 and trip.eventtime <= 1422748799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip where trip.eventtime >= 1420070400 and trip.eventtime <= 1422748799 group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip where trip.eventtime >= 1420070400 and trip.eventtime <= 1422748799 group by overallCategory) SM on RM.roamingcategory=SM.roamingcategory order by roamingcategory
select C.country visitedcountryname, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount mosmscount from (select visitedcountryid visitedcountryname, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip where trip.startTime <= 1422748799 and (trip.endTime= 0 or trip.endtime >= 1420070400) group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1420070400 and trip.eventtime <= 1422748799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname LEFT JOIN (select visitedcountryid visitedcountryname, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip where trip.eventtime >= 1420070400 and trip.eventtime <= 1422748799 group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname LEFT JOIN (select visitedcountryid visitedcountryname, count(*) as mosmscount from out_roamer_message_usage_trip_view trip where trip.eventtime >= 1420070400 and trip.eventtime <= 1422748799 group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip where trip.startTime <= 1422748799 and (trip.endTime= 0 or trip.endtime >= 1420070400) 
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip  where trip.startTime <= 1390953599 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,312,314,318,320,330,333,337,338,340,343,350,356,358,372,380,388,396,398,401,482,408,417,421,426,445,446,457,462,463,464,523,472,481,494,497,501,506,507)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1390953599 and  trip.visitedcountryid in (305,312,314,318,320,330,333,337,338,340,343,350,356,358,372,380,388,396,398,401,482,408,417,421,426,445,446,457,462,463,464,523,472,481,494,497,501,506,507)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1390953599 and  trip.visitedcountryid in (305,312,314,318,320,330,333,337,338,340,343,350,356,358,372,380,388,396,398,401,482,408,417,421,426,445,446,457,462,463,464,523,472,481,494,497,501,506,507)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1390953599 and trip.eventType=0 and  trip.visitedcountryid in (305,312,314,318,320,330,333,337,338,340,343,350,356,358,372,380,388,396,398,401,482,408,417,421,426,445,446,457,462,463,464,523,472,481,494,497,501,506,507)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip  where trip.startTime <= 1390953599 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,312,314,318,320,330,333,337,338,340,343,350,356,358,372,380,388,396,398,401,482,408,417,421,426,445,446,457,462,463,464,523,472,481,494,497,501,506,507)
select distinct countryib.country countryName,countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering from ( select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_view trip where trip.starttime <= 1422719999 and (trip.endtime= 0 or trip.endtime >= 1419998400) ) T inner join countryib on countryib.countryid= T.visitedcountry inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid inner join (select countryid from networkib inner join domestic_subscriber_model subscribermodel on subscribermodel.homeMCC =networkib.mcc and subscribermodel.homeMNC =networkib.mnc inner join (select subscriberIMSI from out_roamer_country_trip_usage_view limit 1) S on S.subscriberIMSI = subscribermodel.subscriberIMSI) C on countryrelationib.homecountryid=C.countryid order by countryName 
select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.device_hierarchy_type categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then 'unknown' else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by tdi.device_hierarchy_type )trip left join(select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then 'unknown' else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where eventtime >=1419998400 and eventtime <= 1422719999 group by eventType, tdi.device_hierarchy_type) voiceview on trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when tdi.device_hierarchy_type is null then 'unknown' else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip inner join tacdeviceib tdi on trip.tac= tdi.tac where eventtime >= 1419998400 and eventtime <= 1422719999 group by tdi.device_hierarchy_type) dataview on trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc, datausage desc;
select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.manufacturer categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then 'unknown' else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by tdi.manufacturer )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then 'unknown' else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, tdi.manufacturer) voiceview on trip.manufacturer = voiceview.manufacturer left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when tdi.manufacturer is null then 'unknown' else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1419998400 and eventtime <= 1422719999 group by tdi.manufacturer) dataview on trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc, datausage desc
select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage datausage, trip.networkGroup networkGroup from (select count(distinct trip.subscriberIMSI) imsicount, case when networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup from out_roamer_country_trip_usage_network_view trip inner join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc inner join networkgroupib networkgroup on network.networkId = networkgroup.networkId where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by networkgroup.networkgroup ) trip left join (select sum (ceil(eventDuration/60.0)) eventDuration,eventType , case when networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup from out_roamer_voice_usage_trip_view trip inner join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc inner join networkgroupib networkgroup on network.networkId = networkgroup.networkId where trip.eventtime >= 1419998400 and trip.eventtime <= 1422719999 group by eventType, networkgroup.networkgroup ) voiceview on trip.networkgroup = voiceview.networkgroup left join (select sum (uplinkUsage + downlinkUsage)/1048576.0 datausage, case when networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup from out_roamer_data_usage_trip_view trip inner join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc inner join networkgroupib networkgroup on network.networkId = networkgroup.networkId where trip.eventtime >= 1419998400 and trip.eventtime <= 1422719999 group by networkgroup.networkgroup ) dataview on trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage datausage, trip.networkName networkName from (select count(distinct trip.subscriberIMSI) imsicount, case when network.networkname is null then 'Unknown' else network.networkname end networkName from out_roamer_country_trip_usage_network_view trip inner join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by network.networkname ) trip left join (select sum (ceil(eventDuration/60.0)) eventDuration,eventType , case when network.networkname is null then 'Unknown' else network.networkname end networkName from out_roamer_voice_usage_trip_view trip inner join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where trip.eventtime >= 1419998400 and trip.eventtime <= 1422719999 group by eventType, network.networkname ) voiceview on trip.networkname = voiceview.networkname left join (select sum (uplinkUsage + downlinkUsage)/1048576.0 datausage, case when network.networkname is null then 'Unknown' else network.networkname end networkName from out_roamer_data_usage_trip_view trip inner join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where trip.eventtime >= 1419998400 and trip.eventtime <= 1422719999 group by network.networkname ) dataview on trip.networkname = dataview.networkname order by imsicount desc
 select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime= 0 or trip.endtime >= 1419998400) 
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.model categoryValue from (select count(distinct trip.subscriberIMSI) imsicount, case when tdi.model is null then 'unknown' else tdi.model end model from out_roamer_country_trip_usage_view trip  inner join tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by tdi.model )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.model is null then 'unknown' else tdi.model end model from out_roamer_voice_usage_trip_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where eventtime >=1419998400 and eventtime <= 1422719999 group by eventType, tdi.model) voiceview on trip.model = voiceview.model left join(select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when tdi.model is null then 'unknown' else tdi.model end model from out_roamer_data_usage_trip_view trip inner join tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1419998400 and eventtime <= 1422719999 group by tdi.model) dataview on trip.model = dataview.model order by imsicount desc, voice desc, datausage desc 
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.mosmscategory categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then -1 else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.mosmscategory )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then -1 else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.mosmscategory) voiceview on trip.mosmscategory = voiceview.mosmscategory left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.mosmscategory is null then -1 else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.mosmscategory) dataview on trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc, datausage desc 
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.mominutecategory categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then -1 else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.mominutecategory )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then -1 else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.mominutecategory) voiceview on trip.mominutecategory = voiceview.mominutecategory left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.mominutecategory is null then -1 else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.mominutecategory) dataview on trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc, datausage desc 
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.tonnagecategory categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.tonnagecategory is null then -1 else trip.tonnagecategory end tonnagecategory from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.tonnagecategory )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.tonnagecategory is null then -1 else trip.tonnagecategory end tonnagecategory from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.tonnagecategory) voiceview on trip.tonnagecategory = voiceview.tonnagecategory left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.tonnagecategory is null then -1 else trip.tonnagecategory end tonnagecategory from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.tonnagecategory) dataview on trip.tonnagecategory = dataview.tonnagecategory order by imsicount desc, voice desc, datausage desc 
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.mtminutecategory categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then -1 else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.mtminutecategory )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then -1 else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.mtminutecategory) voiceview on trip.mtminutecategory = voiceview.mtminutecategory left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.mtminutecategory is null then -1 else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.mtminutecategory) dataview on trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc, datausage desc 
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.paymenttype categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.paymenttype is null then -1 else trip.paymenttype end paymenttype from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.paymenttype )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.paymenttype is null then -1 else trip.paymenttype end paymenttype from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.paymenttype) voiceview on trip.paymenttype = voiceview.paymenttype left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.paymenttype is null then -1 else trip.paymenttype end paymenttype from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.paymenttype) dataview on trip.paymenttype = dataview.paymenttype order by imsicount desc, voice desc, datausage desc;
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.domesticARPU categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.domesticARPU is null then -1 else trip.domesticARPU end domesticARPU from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.domesticARPU )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.domesticARPU is null then -1 else trip.domesticARPU end domesticARPU from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.domesticARPU) voiceview on trip.domesticARPU = voiceview.domesticARPU left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.domesticARPU is null then -1 else trip.domesticARPU end domesticARPU from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.domesticARPU) dataview on trip.domesticARPU = dataview.domesticARPU order by imsicount desc, voice desc, datausage desc
 select trip.imsicount imsicount, voiceview.eventDuration voice, voiceview.eventType eventtype, dataview.datausage, trip.overallcategory categoryValue from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.overallcategory is null then -1 else trip.overallcategory end overallcategory from out_roamer_country_trip_usage_view trip where trip.startTime <= 1422719999 and (trip.endTime=0 or trip.endtime >= 1419998400) group by trip.overallcategory )trip left join (select sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.overallcategory is null then -1 else trip.overallcategory end overallcategory from out_roamer_voice_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by eventType, trip.overallcategory) voiceview on trip.overallcategory = voiceview.overallcategory left join (select sum(uplinkUsage + downlinkUsage) /1048576.0 datausage, case when trip.overallcategory is null then -1 else trip.overallcategory end overallcategory from out_roamer_data_usage_trip_view trip where eventtime >= 1419998400 and eventtime <= 1422719999 group by trip.overallcategory) dataview on trip.overallcategory = dataview.overallcategory order by imsicount desc, voice desc, datausage desc
 