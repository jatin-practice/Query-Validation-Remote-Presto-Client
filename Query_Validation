select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400) 
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select distinct countryib.country countryName, countryregionib.regionName regionName, countryib.countryid countryid,countryib.isleisuredestination leisure,countryib.ispremiumleisuredestination leisurePremium,countryib.countrygdp lowGDP ,countryrelationib.isbordering bordering  from countryib inner join countryrelationib on countryib.countryid =countryrelationib.visitedcountryid  left join countryregionib countryregionib on countryregionib.countryid = countryib.countryid where countryib.countryid in (select distinct trip.visitedcountryid as visitedcountry from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400)  ) and countryrelationib.homecountryid in (select homecountryid from domestic_subscriber_model limit 1) order by countryName
select distinct tadignetwork.networkId networkId, tadignetwork.networkname networkName ,T.mcc mcc, T.mnc mnc, networkgroup.networkgroup networkGroup from ( select distinct trip.visitedmcc as mcc, trip.visitedmnc as mnc from out_roamer_country_trip_usage_network_view trip where trip.starttime <= 1391212799 and (trip.endtime= 0 or trip.endtime >= 1388534400) ) T inner join networkib tadignetwork on T.mcc = tadignetwork.mcc and T.mnc = tadignetwork.mnc inner join networkgroupib networkgroup On tadignetwork.networkId = networkgroup.networkId order by tadignetwork.networkname
select country countryName,  countryid , isocode isocode from countryib
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and  trip.visitedcountryid in (305,312,340,408,426,462,463,481,501)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0) 
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (12,13) 
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (12,13)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (12,13)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (12,13)   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (12,13)   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')
select C.country visitedcountryname,  RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from (select visitedcountryid visitedcountryname,  count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')   group by visitedcountryid) RM LEFT JOIN (select visitedcountryid visitedcountryname,   sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')  group by eventCategory,eventType,visitedcountryid) MO on RM.visitedcountryname=MO.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,   sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')   group by visitedcountryid) DT on RM.visitedcountryname=DT.visitedcountryname  LEFT JOIN (select visitedcountryid visitedcountryname,  count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')   group by visitedcountryid) SM on RM.visitedcountryname=SM.visitedcountryname   inner join countryib C on C.countryid= RM.visitedcountryname order by RM.visitedcountryname
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_network_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (12,13)  and concat(cast(trip.visitedmcc as varchar), concat('-',cast(trip.visitedmnc as varchar)))  in ('613-2','622-1','629-1','630-2','620-6','404-10','404-98','404-90','404-92','639-3','614-2','621-20','635-14','619-1','640-5','641-1','415-1','415-1','608-1','608-1','616-3','616-3','400-1','400-1','206-1','206-1','302-610','302-610','208-20','208-20','626-1','626-1','655-7','655-7','404-74','404-74','460-0','460-0','424-2','616-2','616-2','602-3','616-2','616-2','602-3','424-2','515-2','515-2','627-3','627-3','604-1','604-1','206-20','206-20','415-3','415-3','624-1','612-5','655-10','624-1','612-5','655-10','404-68','404-69','404-68','404-69','610-1','610-1','502-12','502-12','250-2','250-2','206-10','206-10','214-5','214-5','440-10','440-10','627-1','612-3','624-2','623-3','228-3','208-1','610-2','624-2','623-3','627-1','208-1','612-3','610-2','228-3','605-3','605-3','302-720','302-720','208-10','208-10','450-5','450-5','608-2','608-2','454-6','454-6','440-20','440-20','611-1','611-1','228-1','228-1','234-30','310-200','234-30','310-200','605-2','605-2','623-2','623-2','222-1','222-1','615-1','615-1','286-1','286-1','286-1','286-1','631-2','631-2','655-1','655-1','214-1','234-15','214-1','234-15','222-88','222-88','426-2','420-4','426-2','420-4')   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime 
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0  group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.paymenttype in (0)
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.paymenttype in (0)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.paymenttype in (0)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.paymenttype in (0)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.paymenttype in (0)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.paymenttype in (0)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.domesticARPU in (11,13) 
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.domesticARPU in (11,13)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11,13)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.domesticARPU in (11,13)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.domesticARPU in (11,13)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.mominutecategory in (1,3,4) 
select count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime= 0 or trip.endtime >= 1388534400)  and trip.mominutecategory in (1,3,4) 
select trip.imsicount imsicount, trip.overallcategory overalltripcategory, trip.unixtime usagebintime,  voiceview.eventDuration voice, voiceview.eventType eventtype, smsview.mosmscount mosmscount, dataview.datausage datausage from (  select count(distinct trip.subscriberIMSI) imsicount, overallCategory overallcategory, unixTime unixtime   from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by trip.unixTime, trip.overallCategory ) trip  left join ( select  sum(ceil(eventDuration/60.0)) eventDuration, eventType eventtype, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_voice_usage_trip_view trip where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by trip.overallCategory, trip.eventType,eventtime - eventtime % (24*60*60) ) voiceview  on trip.unixTime = voiceview.unixtime and trip.overallCategory = voiceview.overallcategory  left join ( select  count(trip.eventtime) mosmscount, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by  trip.overallCategory , eventtime - eventtime % (24*60*60) ) smsview  on trip.unixTime = smsview.unixtime and trip.overallCategory = smsview.overallcategory  left join ( select  sum(trip.uplinkUsage + trip.downlinkUsage) /1048576.0 datausage, overallCategory overallcategory, eventtime - eventtime % (24*60*60) unixtime  from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and eventtime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by  trip.overallCategory,eventtime - eventtime % (24*60*60) ) dataview  on trip.unixTime = dataview.unixtime and trip.overallCategory = dataview.overallcategory  Union all  select count(distinct trip.subscriberIMSI) imsicount, trip.overallCategory overallcategory,  day_of_week(from_unixtime(trip.unixTime)) usagebintime,   0.0 voice, 0 eventtype, 0 mosmscount, 0.0 datausage from out_roamer_country_trip_usage_time_range_view trip  where trip.unixTime >= 1388534400 and trip.unixTime <=  1391212799  and trip.mominutecategory in (1,3,4)  group by  day_of_week(from_unixtime(trip.unixTime)),  trip.overallCategory  order by usagebintime
select RM.roamingcategory roamingcategory, RM.roamercount roamercount, MO.mocallminutes mocallminutes, MO.eventCategory as mocategory, MO.eventType as motype, DT.datausage datausage,SM.mosmscount  mosmscount from  (select overallCategory roamingcategory, count(distinct trip.subscriberIMSI) as roamercount from out_roamer_country_trip_usage_view trip  where trip.starttime <= 1391212799 and (trip.endtime= 0  or trip.endtime >= 1388534400)  and trip.mominutecategory in (1,3,4)   group by overallCategory) RM LEFT JOIN (select overallCategory roamingcategory, sum(ceil(eventDuration/60.0)) as mocallminutes, eventCategory ,eventType from out_roamer_voice_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.mominutecategory in (1,3,4)  group by eventCategory,eventType,overallCategory) MO on RM.roamingcategory=MO.roamingcategory  LEFT JOIN (select overallCategory roamingcategory, sum(downlinkUsage + uplinkUsage) as datausage from out_roamer_data_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.mominutecategory in (1,3,4)   group by overallCategory) DT on RM.roamingcategory=DT.roamingcategory LEFT JOIN (select overallCategory roamingcategory, count(*) as mosmscount from out_roamer_message_usage_trip_view trip  where trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799 and trip.eventType=0 and trip.mominutecategory in (1,3,4)   group by overallCategory) SM on  RM.roamingcategory=SM.roamingcategory  order by roamingcategory
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkGroup networkGroup  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by networkgroup.networkgroup ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType,  networkgroup.networkgroup ) voiceview  on  trip.networkgroup = voiceview.networkgroup left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  networkgroup.networkgroup is null then 'Unknown' else networkgroup.networkgroup end networkGroup  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc left join networkgroupib networkgroup on network.networkId = networkgroup.networkId where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by networkgroup.networkgroup ) dataview  on  trip.networkgroup = dataview.networkgroup order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage datausage,  trip.networkName networkName  from   (select count(distinct trip.subscriberIMSI) imsicount,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_country_trip_usage_network_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)  group by network.networkname ) trip  left join (select  sum (ceil(eventDuration/60.0)) eventDuration,eventType ,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_voice_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by eventType, network.networkname ) voiceview  on  trip.networkname = voiceview.networkname left join (select  sum (uplinkUsage + downlinkUsage)/1048576.0 datausage,  case when  network.networkname is null then 'Unknown' else network.networkname end networkName  from out_roamer_data_usage_trip_view trip  left join networkib network on trip.visitedmcc = network.mcc and network.mnc=trip.visitedmnc where  trip.eventtime >= 1388534400 and trip.eventtime <= 1391212799  group by network.networkname ) dataview  on  trip.networkname = dataview.networkname order by imsicount desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.manufacturer categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.manufacturer ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.manufacturer) voiceview  on  trip.manufacturer = voiceview.manufacturer left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.manufacturer is null then  'Unknown'  else tdi.manufacturer end manufacturer from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.manufacturer) dataview  on  trip.manufacturer = dataview.manufacturer order by imsicount desc, voice desc,  datausage desc 
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.device_hierarchy_type categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_country_trip_usage_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by tdi.device_hierarchy_type ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_voice_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, tdi.device_hierarchy_type) voiceview  on  trip.device_hierarchy_type = voiceview.device_hierarchy_type left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when tdi.device_hierarchy_type is null then  'Unknown'  else tdi.device_hierarchy_type end device_hierarchy_type from out_roamer_data_usage_trip_view trip  left join  tacdeviceib tdi on trip.tac = tdi.tac where eventtime >= 1388534400 and eventtime <= 1391212799  group by tdi.device_hierarchy_type) dataview  on  trip.device_hierarchy_type = dataview.device_hierarchy_type order by imsicount desc, voice desc,  datausage desc 
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mtminutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mtminutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mtminutecategory) voiceview  on  trip.mtminutecategory = voiceview.mtminutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mtminutecategory is null then  -1  else trip.mtminutecategory end mtminutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mtminutecategory) dataview  on  trip.mtminutecategory = dataview.mtminutecategory order by imsicount desc, voice desc,  datausage desc
 select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mosmscategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mosmscategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mosmscategory) voiceview  on  trip.mosmscategory = voiceview.mosmscategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mosmscategory is null then  -1  else trip.mosmscategory end mosmscategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mosmscategory) dataview  on  trip.mosmscategory = dataview.mosmscategory order by imsicount desc, voice desc,  datausage desc
select trip.imsicount imsicount,  voiceview.eventDuration voice,  voiceview.eventType eventtype,  dataview.datausage,  trip.mominutecategory categoryValue  from ( select count(distinct trip.subscriberIMSI) imsicount, case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_country_trip_usage_view trip  where trip.startTime <= 1391212799 and (trip.endTime=0 or trip.endtime >= 1388534400)   group by trip.mominutecategory ) trip  left join (select  sum(ceil(eventDuration/60.0)) eventDuration, eventType ,case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_voice_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by eventType, trip.mominutecategory) voiceview  on  trip.mominutecategory = voiceview.mominutecategory left join (select  sum(uplinkUsage + downlinkUsage) /1048576.0 datausage,  case when trip.mominutecategory is null then  -1  else trip.mominutecategory end mominutecategory from out_roamer_data_usage_trip_view trip  where eventtime >= 1388534400 and eventtime <= 1391212799  group by trip.mominutecategory) dataview  on  trip.mominutecategory = dataview.mominutecategory order by imsicount desc, voice desc,  datausage desc  